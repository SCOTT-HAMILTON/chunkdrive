!function(){"use strict";function a(e){var t;if(window.uploading)return t='You are uploading "'.concat(window.uploading,'". Are you sure you want to leave?'),(e||window.event).returnValue=t}function o(e){var t,n,o,a=e.querySelector("input[type=file]").files[0];null!=a&&(window.uploading=a.name,t=document.getElementById("progress-overlay"),n=t.querySelector(".progress-bar"),t.querySelector(".filename").textContent=a.name,t.classList.add("show"),(o=new XMLHttpRequest).open("POST",e.action,!0),o.upload.onprogress=function(e){e.lengthComputable&&(e=e.loaded/e.total*100,n.style.width=e+"%")},o.onload=function(){delete window.uploading,window.location.href=o.responseURL},o.send(new FormData(e)))}function r(e){e.preventDefault(),o(e.target)}function n(){var e,t,n,o=document.querySelector("form.file-upload");null!=o&&((e=document.createElement("div")).classList.add("overlay"),e.id="progress-overlay",(t=document.createElement("span")).classList.add("filename"),e.appendChild(t),(t=document.createElement("div")).classList.add("progress-container"),(n=document.createElement("div")).classList.add("progress-bar"),t.appendChild(n),e.appendChild(t),document.querySelector("body").appendChild(e),o.addEventListener("submit",r,!1),window.addEventListener("beforeunload",a,!1))}function d(){document.getElementById("drag-overlay").classList.add("show")}function i(){document.getElementById("drag-overlay").classList.remove("show")}function l(e){0===e.pageX&&0===e.pageY&&i()}function c(e){i();var t=document.querySelector("form.file-upload"),n=t.querySelector('input[type="file"]'),e=e.dataTransfer.files;0!==e.length&&(1<e.length?alert("Please only upload one file at a time."):(n.files=e,o(t)))}function u(e){e.preventDefault(),e.stopPropagation()}window.addEventListener("load",function(){var e,t;e=document.getElementById("theme-switcher"),"true"===localStorage.getItem("invertTheme")&&(e.checked=!0),e.addEventListener("change",function(){e.checked?localStorage.setItem("invertTheme","true"):localStorage.setItem("invertTheme","false")}),window.config.readonly||((t=document.createElement("div")).classList.add("overlay"),t.id="drag-overlay",document.querySelector("body").appendChild(t),window.addEventListener("dragenter",d,!1),window.addEventListener("dragover",d,!1),window.addEventListener("drop",c,!1),window.addEventListener("dragleave",l,!1),["dragenter","dragover","dragleave","drop"].forEach(function(e){window.addEventListener(e,u,!1)}),document.querySelectorAll(".destructive form").forEach(function(n){n.addEventListener("submit",function(e){var t=n.getAttribute("action").split("/").pop().split("$").pop(),t='You are about to irreversibly change "'.concat(t,'". Are you sure?');confirm(t)||e.preventDefault()})}),n())})}();
